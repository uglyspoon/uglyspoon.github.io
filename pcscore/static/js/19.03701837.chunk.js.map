{"version":3,"sources":["containers/studentinfo/components/Dropzone.tsx","containers/studentinfo/components/DataModal.tsx","components/StandardTable/index.tsx","assets/xls.svg","assets/xlsx.svg","assets/trash.svg","assets/ZIP.svg","assets/RAR.svg"],"names":["Dropzone","_ref","saveFile","content","accept","_useState","useState","_useState2","Object","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","files","setFiles","onDrop","useCallback","acceptedFiles","length","antd_es_message__WEBPACK_IMPORTED_MODULE_1__","warning","map","file","name","lastModified","suffix","split","pop","toLocaleLowerCase","_useDropzone","useDropzone","getRootProps","getInputProps","onClickDelete","e","react__WEBPACK_IMPORTED_MODULE_3___default","a","createElement","className","styles","container","item","idx","key","src","XLSX","alt","XLS","ZIP","RAR","TRASH","style","width","cursor","data-index","onClick","whyDidYouRender","React","memo","defaultStatus","uploaded","failNum","successNum","totalNum","react__WEBPACK_IMPORTED_MODULE_12___default","Fragment","marginTop","columns","title","dataIndex","DataModal","visible","toggleVisible","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_11__","setFile","_useState3","_useState4","upStatus","setUpStatus","formData","FormData","append","downloadTemplateFile","_ref2","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_10__","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_9___default","mark","_callee","event","res","aElem","evt","wrap","_context","prev","next","preventDefault","request","url","method","sent","isSuccess","document","href","configs","HOST","createEvent","initEvent","dispatchEvent","stop","_x","apply","this","arguments","handleSubmit","_ref3","_callee2","_context2","data","headers","Content-Type","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_8__","antd_es_modal__WEBPACK_IMPORTED_MODULE_1__","onCancel","centered","footer","alignItems","justifyContent","display","antd_es_button__WEBPACK_IMPORTED_MODULE_7__","undefined","disabled","type","antd_es_alert__WEBPACK_IMPORTED_MODULE_5__","message","description","marginBottom","marginRight","antd_es_icon__WEBPACK_IMPORTED_MODULE_3__","color","components_StandardTable__WEBPACK_IMPORTED_MODULE_17__","rowKey","list","pagination","_Dropzone__WEBPACK_IMPORTED_MODULE_13__","initTotalList","totalList","forEach","column","needTotal","push","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_10__","total","StandardTable","props","_this","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_5__","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__","call","handleRowSelectChange","selectedRowKeys","selectedRows","currySelectedRowKeys","needTotalList","state","reduce","sum","val","parseFloat","onSelectRow","setState","handleTableChange","filters","sorter","onChange","_len","rest","Array","_key","concat","cleanSelectedKeys","nextProps","_this$state","_this$props","_this$props$needSelec","needSelectRows","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_4__","_ref$list","_ref$pagination","paginationProps","showSizeChanger","showQuickJumper","rowSelection","getCheckboxProps","record","react__WEBPACK_IMPORTED_MODULE_11___default","standardTable","tableAlert","antd_es_alert__WEBPACK_IMPORTED_MODULE_3__","react__WEBPACK_IMPORTED_MODULE_11__","fontWeight","index","marginLeft","render","showIcon","antd_es_table__WEBPACK_IMPORTED_MODULE_1__","assign","dataSource","Component","module","exports","__webpack_require__","p"],"mappings":"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","file":"static/js/19.03701837.chunk.js","sourcesContent":["import React, {useCallback, useState } from 'react'\nimport {useDropzone} from 'react-dropzone'\nimport styles from './Dropzone.less'\nimport XLS from 'assets/xls.svg';\nimport XLSX from 'assets/xlsx.svg';\nimport TRASH from 'assets/trash.svg';\nimport { message } from 'antd';\nimport ZIP from 'assets/ZIP.svg';\nimport RAR from 'assets/RAR.svg';\n\ntype fileType = {\n  name: string;\n  lastModified: number;\n  suffix: string;\n}\n\ntype DropzonePropsType = {\n  saveFile: (file: File) => void;\n  content: any;\n  accept: string[];\n}\n\nfunction Dropzone({ saveFile, content, accept }: DropzonePropsType) {\n  const [files, setFiles] = useState<fileType[]>([]);\n  const onDrop = useCallback(acceptedFiles => {\n    if (!acceptedFiles.length) {\n      message.warning('请检查文件格式之后再试~')\n    }\n    setFiles(acceptedFiles.map((file:fileType ) => ({\n      name: file.name,\n      lastModified: file.lastModified,\n      suffix: (file.name.split('.').pop() || '').toLocaleLowerCase()\n    })))\n\n    saveFile(acceptedFiles[0])\n  }, [saveFile])\n\n  const { getRootProps, getInputProps} = useDropzone({ onDrop, accept});\n\n  const onClickDelete = (e: any) => {\n    setFiles([])\n  }\n  return (\n    <section className={styles.container}>\n      {\n        files.length ?\n          <div className='dropzone'>\n            {files.map((item, idx) => {\n              return <div key={item.lastModified} className=\"file-container\">\n                <div>\n                  {item.suffix === 'xlsx' && <img src={XLSX} alt=\"xlsx\" />}\n                  {item.suffix === 'xls' && <img src={XLS} alt=\"xls\" />}\n                  {item.suffix === 'zip' && <img src={ZIP} alt=\"zip\" />}\n                  {item.suffix === 'rar' && <img src={RAR} alt=\"zip\" />}\n\n                  <span className=\"file-title\">{item.name}</span>\n                </div>\n                <img src={TRASH} alt=\"\" style={{ width: 20, cursor: 'pointer' }} data-index={idx} onClick={onClickDelete}/>\n              </div>\n            })}\n          </div> :\n          <div {...getRootProps({className: 'dropzone'})}>\n            <input {...getInputProps()} />\n            {content}\n          </div>\n      }\n    </section>\n  );\n}\nDropzone.whyDidYouRender = true;\nexport default React.memo(Dropzone);\n","import React, {useState, useCallback} from 'react';\nimport { Modal, Button, Alert, Icon } from 'antd';\nimport MyDropzone from './Dropzone';\nimport request from 'utils/request';\nimport { isSuccess } from 'utils';\nimport configs from 'utils/config';\nimport StandardTable, {StandardTableColumnProps} from 'components/StandardTable';\nimport XLS from 'assets/xls.svg';\nimport XLSX from 'assets/xlsx.svg';\nimport TRASH from 'assets/trash.svg';\n\ntype ModalPropsType  = {\n  visible: boolean;\n  toggleVisible: any;\n}\n\nconst defaultStatus = { uploaded: false, failNum: 0, successNum: 0, totalNum: 0 };\nconst content = (\n  <>\n    <img src={XLS} alt=\"\" style={{width:60}}/>\n    <h1 style={{marginTop: 20}}>将模版拖拽至此区域 或 <a>点击上传</a></h1>\n    <span>仅限制上传10M以下xls或xlsx格式文件</span>\n  </>\n)\nconst accept = ['.xlsx', 'xls'];\nconst columns:StandardTableColumnProps[] = [\n  {\n    title: '学生',\n    dataIndex: 'name',\n  },\n  {\n    title: '性别',\n    dataIndex: 'sexStr',\n  },\n  {\n    title: '年龄',\n    dataIndex: 'age',\n  },\n  {\n    title: '学号',\n    dataIndex: 'sn',\n  },\n  {\n    title: '院系',\n    dataIndex: 'college',\n  },\n  {\n    title: '年级',\n    dataIndex: 'grade',\n  },\n  {\n    title: '班级',\n    dataIndex: 'clazz',\n  },\n]\nconst DataModal = ({visible, toggleVisible}: ModalPropsType) => {\n\n  const [file, setFile] = useState()\n  const [upStatus, setUpStatus] = useState(defaultStatus)\n\n  const saveFile = useCallback((file: File) => {\n    let formData = new FormData();\n    formData.append('file', file);\n\n    setFile(formData)\n\n  }, [setFile])\n\n  const downloadTemplateFile = async (event: any) => {\n    event.preventDefault();\n    const res = await request({\n      url: '/file/downloadStuModel',\n      method:'get'\n    })\n    if (isSuccess(res)) {\n      let aElem = document.createElement('a');\n      aElem.href = configs.HOST + '/admin/excel/studentModel.xlsx';\n      var evt = document.createEvent(\"MouseEvents\");\n      evt.initEvent(\"click\", true, true);\n      aElem.dispatchEvent(evt);\n    }\n  }\n\n  const handleSubmit = async () => {\n    const res  = await request({\n      url: '/file/importStuModel',\n      data: file,\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    })\n    if (isSuccess(res)) {\n      setUpStatus({\n        uploaded: true,\n        ...res.data\n      })\n    }\n  }\n  const resetModal = () => {\n    setFile(undefined)\n    setUpStatus(defaultStatus)\n  }\n\n  return (\n    <Modal\n      title=\"上传基础数据\"\n      width=\"60%\"\n      visible={visible}\n      onCancel={toggleVisible}\n      centered\n      footer={\n        <div style={{ alignItems: 'center', justifyContent: 'center', display:'flex' }}>\n          {\n            upStatus.uploaded ?\n              <Button onClick={resetModal} disabled={!file}>再次上传</Button> :\n              <Button type='primary' onClick={handleSubmit} disabled={!file}>上传</Button>\n          }\n\n        </div>\n      }\n    >\n      <Alert\n        message=\"注意事项\"\n        description={\n          <>\n            <p><b>1.</b>上传前请先下载标准Excel模版并按照标准模版中的说明编辑文件</p>\n            <p><b>2.</b>一次最多上传1000行数据，文件大小不能超过10M</p>\n            <p><b>3.</b>支持xls或xlsx格式的文件</p>\n          </>\n        }\n        type=\"info\"\n      />\n\n      <div style={{marginTop:20, marginBottom: 10}}>\n        <a href=\"\" style={{ marginRight: 20 }} onClick={downloadTemplateFile}>\n          <Icon type=\"file\" style={{marginRight: 5}}/>下载标准Excel模版\n        </a>\n        <span>(上传前请先下载标准Excel模版并按照标准模版中的说明编辑文件)</span>\n      </div>\n      {\n        upStatus.uploaded ?\n          <>\n            <h3>共上传\n              <b style={{ color: '#1890ff' }}>{upStatus.totalNum}</b>条数据,\n              成功<b style={{ color: '#1890ff' }}>{upStatus.successNum}</b>条,\n              失败<b style={{ color: '#FF4D4F' }}>{upStatus.failNum}</b>条\n            </h3>\n            <StandardTable\n              rowKey='key'\n              columns={columns}\n              data={{\n                list: [{name: '123', key:1}],\n                pagination: {}\n              }}\n            />\n          </> :\n          <MyDropzone\n            saveFile={saveFile}\n            content={content}\n            accept={accept}\n          />\n      }\n    </Modal>\n  )\n}\nDataModal.whyDidYouRender = true\n\nexport default React.memo(DataModal)\n","import { Alert, Table } from 'antd';\nimport { ColumnProps, TableRowSelection, TableProps } from 'antd/es/table';\nimport React, { Component, Fragment } from 'react';\n\nimport { TableListItem } from './data.d';\nimport styles from './index.less';\ntype Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>;\n\nexport interface StandardTableProps<T> extends Omit<TableProps<T>, 'columns'> {\n  columns: StandardTableColumnProps[];\n  data: {\n    list: TableListItem[];\n    pagination: StandardTableProps<TableListItem>['pagination'];\n  };\n  selectedRows?: TableListItem[];\n  needSelectRows?: boolean;\n  onSelectRow?: (rows: any) => void;\n}\n\nexport interface StandardTableColumnProps extends ColumnProps<TableListItem> {\n  needTotal?: boolean;\n  total?: number;\n}\n\nfunction initTotalList(columns: StandardTableColumnProps[]) {\n  if (!columns) {\n    return [];\n  }\n  const totalList: StandardTableColumnProps[] = [];\n  columns.forEach(column => {\n    if (column.needTotal) {\n      totalList.push({ ...column, total: 0 });\n    }\n  });\n  return totalList;\n}\n\ninterface StandardTableState {\n  selectedRowKeys: string[];\n  needTotalList: StandardTableColumnProps[];\n}\n\nclass StandardTable extends Component<StandardTableProps<TableListItem>, StandardTableState> {\n  static getDerivedStateFromProps(nextProps: StandardTableProps<TableListItem>) {\n    // clean state\n    if (nextProps.selectedRows && nextProps.selectedRows.length === 0) {\n      const needTotalList = initTotalList(nextProps.columns);\n      return {\n        selectedRowKeys: [],\n        needTotalList,\n      };\n    }\n    return null;\n  }\n\n  constructor(props: StandardTableProps<TableListItem>) {\n    super(props);\n    const { columns } = props;\n    const needTotalList = initTotalList(columns);\n\n    this.state = {\n      selectedRowKeys: [],\n      needTotalList,\n    };\n  }\n\n  handleRowSelectChange: TableRowSelection<TableListItem>['onChange'] = (\n    selectedRowKeys,\n    selectedRows: TableListItem[],\n  ) => {\n    const currySelectedRowKeys = selectedRowKeys as string[];\n    let { needTotalList } = this.state;\n    needTotalList = needTotalList.map(item => ({\n      ...item,\n      total: selectedRows.reduce((sum, val) => sum + parseFloat(val[item.dataIndex || 0]), 0),\n    }));\n    const { onSelectRow } = this.props;\n    if (onSelectRow) {\n      onSelectRow(selectedRows);\n    }\n\n    this.setState({ selectedRowKeys: currySelectedRowKeys, needTotalList });\n  };\n\n  handleTableChange: TableProps<TableListItem>['onChange'] = (\n    pagination,\n    filters,\n    sorter,\n    ...rest\n  ) => {\n    const { onChange } = this.props;\n    if (onChange) {\n      onChange(pagination, filters, sorter, ...rest);\n    }\n  };\n\n  cleanSelectedKeys = () => {\n    if (this.handleRowSelectChange) {\n      this.handleRowSelectChange([], []);\n    }\n  };\n\n  render() {\n    const { selectedRowKeys, needTotalList } = this.state;\n    const { data, rowKey, needSelectRows=false, ...rest } = this.props;\n    const { list = [], pagination = false } = data || {};\n\n    const paginationProps = pagination ? {\n      showSizeChanger: true,\n      showQuickJumper: true,\n      ...pagination,\n    } : false;\n\n    const rowSelection: TableRowSelection<TableListItem> = {\n      selectedRowKeys,\n      onChange: this.handleRowSelectChange,\n      getCheckboxProps: (record: TableListItem) => ({\n        disabled: record.disabled,\n      }),\n    };\n\n    return (\n      <div className={styles.standardTable}>\n        {needSelectRows ?\n          <div className={styles.tableAlert}>\n            <Alert\n              message={\n                <Fragment>\n                  已选择 <a style={{ fontWeight: 600 }}>{selectedRowKeys.length}</a> 项&nbsp;&nbsp;\n                  {needTotalList.map((item, index) => (\n                    <span style={{ marginLeft: 8 }} key={item.dataIndex}>\n                      {item.title}\n                      总计&nbsp;\n                      <span style={{ fontWeight: 600 }}>\n                        {item.render\n                          ? item.render(item.total, item as TableListItem, index)\n                          : item.total}\n                      </span>\n                    </span>\n                  ))}\n                  <a onClick={this.cleanSelectedKeys} style={{ marginLeft: 24 }}>\n                    清空\n                  </a>\n                </Fragment>\n              }\n              type=\"info\"\n              showIcon\n            />\n          </div> :\n          null\n        }\n        <Table\n          rowKey={rowKey || 'key'}\n          rowSelection={needSelectRows ? rowSelection : undefined}\n          dataSource={list}\n          pagination={paginationProps}\n          onChange={this.handleTableChange}\n          {...rest}\n        />\n      </div>\n    );\n  }\n}\n\nexport default StandardTable;\n","module.exports = __webpack_public_path__ + \"static/media/xls.e3b573bf.svg\";","module.exports = __webpack_public_path__ + \"static/media/xlsx.99625958.svg\";","module.exports = __webpack_public_path__ + \"static/media/trash.3d4303e4.svg\";","module.exports = __webpack_public_path__ + \"static/media/ZIP.f176b939.svg\";","module.exports = __webpack_public_path__ + \"static/media/RAR.a1b093e9.svg\";"],"sourceRoot":""}