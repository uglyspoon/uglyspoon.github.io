{"version":3,"sources":["containers/studentinfo/components/Dropzone.tsx","containers/studentinfo/components/PicModal.tsx","components/StandardTable/index.tsx","assets/xls.svg","assets/xlsx.svg","assets/trash.svg","assets/ZIP.svg","assets/RAR.svg"],"names":["Dropzone","_ref","saveFile","content","accept","_useState","useState","_useState2","Object","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","files","setFiles","onDrop","useCallback","acceptedFiles","length","antd_es_message__WEBPACK_IMPORTED_MODULE_1__","warning","map","file","name","lastModified","suffix","split","pop","toLocaleLowerCase","_useDropzone","useDropzone","getRootProps","getInputProps","onClickDelete","e","react__WEBPACK_IMPORTED_MODULE_3___default","a","createElement","className","styles","container","item","idx","key","src","XLSX","alt","XLS","ZIP","RAR","TRASH","style","width","cursor","data-index","onClick","whyDidYouRender","React","memo","defaultStatus","uploaded","failNum","successNum","totalNum","errorList","columns","title","dataIndex","UploadModal","visible","toggleVisible","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_9__","setFile","_useState3","_useState4","upStatus","setUpStatus","handleSubmit","_ref2","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_8__","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_6___default","mark","_callee","res","wrap","_context","prev","next","request","url","data","headers","Content-Type","sent","isSuccess","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_7__","stop","apply","this","arguments","react__WEBPACK_IMPORTED_MODULE_10___default","Fragment","display","marginTop","antd_es_modal__WEBPACK_IMPORTED_MODULE_1__","onCancel","centered","footer","alignItems","justifyContent","antd_es_button__WEBPACK_IMPORTED_MODULE_5__","undefined","disabled","type","antd_es_alert__WEBPACK_IMPORTED_MODULE_3__","message","description","marginBottom","color","components_StandardTable__WEBPACK_IMPORTED_MODULE_14__","rowKey","list","pagination","_Dropzone__WEBPACK_IMPORTED_MODULE_11__","formData","FormData","append","initTotalList","totalList","forEach","column","needTotal","push","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_10__","total","StandardTable","props","_this","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_5__","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__","call","handleRowSelectChange","selectedRowKeys","selectedRows","currySelectedRowKeys","needTotalList","state","reduce","sum","val","parseFloat","onSelectRow","setState","handleTableChange","filters","sorter","onChange","_len","rest","Array","_key","concat","cleanSelectedKeys","nextProps","_this$state","_this$props","_this$props$needSelec","needSelectRows","_Users_spoon_WWW_dabai_antd_demo_ts_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_4__","_ref$list","_ref$pagination","paginationProps","showSizeChanger","showQuickJumper","rowSelection","getCheckboxProps","record","react__WEBPACK_IMPORTED_MODULE_11___default","standardTable","tableAlert","react__WEBPACK_IMPORTED_MODULE_11__","fontWeight","index","marginLeft","render","showIcon","antd_es_table__WEBPACK_IMPORTED_MODULE_1__","assign","dataSource","Component","module","exports","__webpack_require__","p"],"mappings":"wQAsBA,SAASA,EAATC,GAAoE,IAAhDC,EAAgDD,EAAhDC,SAAUC,EAAsCF,EAAtCE,QAASC,EAA6BH,EAA7BG,OAA6BC,EACxCC,mBAAqB,IADmBC,EAAAC,OAAAC,EAAA,EAAAD,CAAAH,EAAA,GAC3DK,EAD2DH,EAAA,GACpDI,EADoDJ,EAAA,GAE5DK,EAASC,sBAAY,SAAAC,GACpBA,EAAcC,QACjBC,EAAA,EAAQC,QAAQ,uEAElBN,EAASG,EAAcI,IAAI,SAACC,GAAD,MAAqB,CAC9CC,KAAMD,EAAKC,KACXC,aAAcF,EAAKE,aACnBC,QAASH,EAAKC,KAAKG,MAAM,KAAKC,OAAS,IAAIC,wBAG7CvB,EAASY,EAAc,KACtB,CAACZ,IAb8DwB,EAe3BC,YAAY,CAAEf,SAAQR,WAArDwB,EAf0DF,EAe1DE,aAAcC,EAf4CH,EAe5CG,cAEhBC,EAAgB,SAACC,GACrBpB,EAAS,KAEX,OACEqB,EAAAC,EAAAC,cAAA,WAASC,UAAWC,IAAOC,WAEvB3B,EAAMK,OACJiB,EAAAC,EAAAC,cAAA,OAAKC,UAAU,YACZzB,EAAMQ,IAAI,SAACoB,EAAMC,GAChB,OAAOP,EAAAC,EAAAC,cAAA,OAAKM,IAAKF,EAAKjB,aAAcc,UAAU,kBAC5CH,EAAAC,EAAAC,cAAA,WACmB,SAAhBI,EAAKhB,QAAqBU,EAAAC,EAAAC,cAAA,OAAKO,IAAKC,IAAMC,IAAI,SAC9B,QAAhBL,EAAKhB,QAAoBU,EAAAC,EAAAC,cAAA,OAAKO,IAAKG,IAAKD,IAAI,QAC5B,QAAhBL,EAAKhB,QAAoBU,EAAAC,EAAAC,cAAA,OAAKO,IAAKI,IAAKF,IAAI,QAC5B,QAAhBL,EAAKhB,QAAoBU,EAAAC,EAAAC,cAAA,OAAKO,IAAKK,IAAKH,IAAI,QAE7CX,EAAAC,EAAAC,cAAA,QAAMC,UAAU,cAAcG,EAAKlB,OAErCY,EAAAC,EAAAC,cAAA,OAAKO,IAAKM,IAAOJ,IAAI,GAAGK,MAAO,CAAEC,MAAO,GAAIC,OAAQ,WAAaC,aAAYZ,EAAKa,QAAStB,QAIjGE,EAAAC,EAAAC,cAAA,MAASN,EAAa,CAACO,UAAW,aAChCH,EAAAC,EAAAC,cAAA,QAAWL,KACV1B,IAMbH,EAASqD,iBAAkB,EACZC,cAAMC,KAAKvD,oOCxDpBwD,EAAgB,CAAEC,UAAU,EAAOC,QAAS,EAAGC,WAAY,EAAGC,SAAU,EAAGC,UAAU,IACrFzD,EAAmB,CAAC,OAAQ,QAE5B0D,EAAqC,CACzC,CACEC,MAAO,eACPC,UAAW,QAEb,CACED,MAAO,eACPC,UAAW,UAEb,CACED,MAAO,eACPC,UAAW,OAEb,CACED,MAAO,eACPC,UAAW,MAEb,CACED,MAAO,eACPC,UAAW,WAEb,CACED,MAAO,eACPC,UAAW,SAEb,CACED,MAAO,eACPC,UAAW,UAITC,EAAc,SAAAhE,GAA8C,IAA5CiE,EAA4CjE,EAA5CiE,QAASC,EAAmClE,EAAnCkE,cAAmC9D,EAExCC,qBAFwCC,EAAAC,OAAA4D,EAAA,EAAA5D,CAAAH,EAAA,GAEzDc,EAFyDZ,EAAA,GAEnD8D,EAFmD9D,EAAA,GAAA+D,EAGhChE,mBAASkD,GAHuBe,EAAA/D,OAAA4D,EAAA,EAAA5D,CAAA8D,EAAA,GAGzDE,EAHyDD,EAAA,GAG/CE,EAH+CF,EAAA,GAW1DG,EAAY,eAAAC,EAAAnE,OAAAoE,EAAA,EAAApE,CAAAqE,EAAA5C,EAAA6C,KAAG,SAAAC,IAAA,IAAAC,EAAA,OAAAH,EAAA5C,EAAAgD,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EACAC,YAAQ,CACzBC,IAAK,mBACLC,KAAMpE,EACNqE,QAAS,CACPC,eAAgB,yBALD,OACbT,EADaE,EAAAQ,KAQfC,YAAUX,IACZP,EAAYjE,OAAAoF,EAAA,EAAApF,CAAA,CACViD,UAAU,GACPuB,EAAIO,OAXQ,wBAAAL,EAAAW,SAAAd,MAAH,yBAAAJ,EAAAmB,MAAAC,KAAAC,YAAA,GAmBZ7F,EACJ8F,EAAAhE,EAAAC,cAAA+D,EAAAhE,EAAAiE,SAAA,KACED,EAAAhE,EAAAC,cAAA,OAAKc,MAAO,CAAEmD,QAAQ,SACpBF,EAAAhE,EAAAC,cAAA,OAAKO,IAAKI,IAAKF,IAAI,GAAGK,MAAO,CAAEC,MAAO,MACtCgD,EAAAhE,EAAAC,cAAA,OAAKO,IAAKK,IAAKH,IAAI,GAAGK,MAAO,CAACC,MAAM,OAEtCgD,EAAAhE,EAAAC,cAAA,MAAIc,MAAO,CAACoD,UAAW,KAAvB,iEAAwCH,EAAAhE,EAAAC,cAAA,sCACxC+D,EAAAhE,EAAAC,cAAA,mGAGJ,OACE+D,EAAAhE,EAAAC,cAAAmE,EAAA,GACEtC,MAAM,uCACNd,MAAM,MACNiB,QAASA,EACToC,SAAUnC,EACVoC,UAAQ,EACRC,OACEP,EAAAhE,EAAAC,cAAA,OAAKc,MAAO,CAAEyD,WAAY,SAAUC,eAAgB,SAAUP,QAAQ,SAElE3B,EAASf,SACPwC,EAAAhE,EAAAC,cAAAyE,EAAA,GAAQvD,QAzBD,WACjBiB,OAAQuC,GACRnC,EAAYjB,IAuB2BqD,UAAW1F,GAAxC,4BACA8E,EAAAhE,EAAAC,cAAAyE,EAAA,GAAQG,KAAK,UAAU1D,QAASsB,EAAcmC,UAAW1F,GAAzD,kBAMR8E,EAAAhE,EAAAC,cAAA6E,EAAA,GACEC,QAAQ,2BACRC,YACEhB,EAAAhE,EAAAC,cAAA+D,EAAAhE,EAAAiE,SAAA,KACED,EAAAhE,EAAAC,cAAA,SAAG+D,EAAAhE,EAAAC,cAAA,eAAH,yHACA+D,EAAAhE,EAAAC,cAAA,SAAG+D,EAAAhE,EAAAC,cAAA,eAAH,4IACA+D,EAAAhE,EAAAC,cAAA,SAAG+D,EAAAhE,EAAAC,cAAA,eAAH,2DAGJ4E,KAAK,SAGPb,EAAAhE,EAAAC,cAAA,OAAKc,MAAO,CAACoD,UAAU,GAAIc,aAAc,MAGvC1C,EAASf,SACPwC,EAAAhE,EAAAC,cAAA+D,EAAAhE,EAAAiE,SAAA,KACED,EAAAhE,EAAAC,cAAA,+BACE+D,EAAAhE,EAAAC,cAAA,KAAGc,MAAO,CAAEmE,MAAO,YAAc3C,EAASZ,UAD5C,mCAEIqC,EAAAhE,EAAAC,cAAA,KAAGc,MAAO,CAAEmE,MAAO,YAAc3C,EAASb,YAF9C,uBAGIsC,EAAAhE,EAAAC,cAAA,KAAGc,MAAO,CAAEmE,MAAO,YAAc3C,EAASd,SAH9C,UAMEc,EAASX,UAAU9C,OACjBkF,EAAAhE,EAAAC,cAAA+D,EAAAhE,EAAAiE,SAAA,KACED,EAAAhE,EAAAC,cAAA,MAAIc,MAAO,CAACmE,MAAO,QAAnB,mEACAlB,EAAAhE,EAAAC,cAAA,UAEIsC,EAASX,UAAU3C,IAAI,SAAAoB,GACrB,OAAO2D,EAAAhE,EAAAC,cAAA,MAAIM,IAAKF,GAAOA,OAM/B,KAEJ2D,EAAAhE,EAAAC,cAACkF,EAAA,EAAD,CACEC,OAAO,MACPvD,QAASA,EACTyB,KAAM,CACJ+B,KAAM,CAAC,CAAClG,KAAM,MAAOoB,IAAI,IACzB+E,WAAY,OAIlBtB,EAAAhE,EAAAC,cAACsF,EAAA,QAAD,CACEtH,SApGO,SAACiB,GAChB,IAAIsG,EAAW,IAAIC,SACnBD,EAASE,OAAO,OAAQxG,GACxBkD,EAAQoD,IAkGAtH,QAASA,EACTC,OAAQA,MAMpB6D,EAAYZ,iBAAkB,EAEfC,cAAMC,KAAKU,iMC3I1B,SAAS2D,EAAc9D,GACrB,IAAKA,EACH,MAAO,GAET,IAAM+D,EAAwC,GAM9C,OALA/D,EAAQgE,QAAQ,SAAAC,GACVA,EAAOC,WACTH,EAAUI,KAAVzH,OAAA0H,EAAA,EAAA1H,CAAA,GAAoBuH,EAApB,CAA4BI,MAAO,OAGhCN,MAQHO,cAaJ,SAAAA,EAAYC,GAA0C,IAAAC,EAAA9H,OAAA+H,EAAA,EAAA/H,CAAAuF,KAAAqC,IACpDE,EAAA9H,OAAAgI,EAAA,EAAAhI,CAAAuF,KAAAvF,OAAAiI,EAAA,EAAAjI,CAAA4H,GAAAM,KAAA3C,KAAMsC,KAURM,sBAAsE,SACpEC,EACAC,GAEA,IAAMC,EAAuBF,EACvBG,EAAkBT,EAAKU,MAAvBD,cACNA,EAAgBA,EAAc7H,IAAI,SAAAoB,GAAI,OAAA9B,OAAA0H,EAAA,EAAA1H,CAAA,GACjC8B,EADiC,CAEpC6F,MAAOU,EAAaI,OAAO,SAACC,EAAKC,GAAN,OAAcD,EAAME,WAAWD,EAAI7G,EAAK0B,WAAa,KAAK,OALpF,IAOKqF,EAAgBf,EAAKD,MAArBgB,YACJA,GACFA,EAAYR,GAGdP,EAAKgB,SAAS,CAAEV,gBAAiBE,EAAsBC,mBA1BHT,EA6BtDiB,kBAA2D,SACzDhC,EACAiC,EACAC,GAEG,IACKC,EAAapB,EAAKD,MAAlBqB,SACR,GAAIA,EAAU,SAAAC,EAAA3D,UAAAjF,OAHX6I,EAGW,IAAAC,MAAAF,EAAA,EAAAA,EAAA,KAAAG,EAAA,EAAAA,EAAAH,EAAAG,IAHXF,EAGWE,EAAA,GAAA9D,UAAA8D,GACZJ,EAAQ5D,WAAR,GAASyB,EAAYiC,EAASC,GAA9BM,OAAyCH,MArCStB,EAyCtD0B,kBAAoB,WACd1B,EAAKK,uBACPL,EAAKK,sBAAsB,GAAI,KA3CmB,IAG9CI,EAAgBnB,EADFS,EAAZvE,SAF4C,OAKpDwE,EAAKU,MAAQ,CACXJ,gBAAiB,GACjBG,iBAPkDT,6FAZtB2B,GAE9B,OAAIA,EAAUpB,cAAkD,IAAlCoB,EAAUpB,aAAa9H,OAE5C,CACL6H,gBAAiB,GACjBG,cAHoBnB,EAAcqC,EAAUnG,UAMzC,uDAkDA,IAAAoG,EACoCnE,KAAKiD,MAAxCJ,EADDsB,EACCtB,gBAAiBG,EADlBmB,EACkBnB,cADlBoB,EAEiDpE,KAAKsC,MAArD9C,EAFD4E,EAEC5E,KAAM8B,EAFP8C,EAEO9C,OAFP+C,EAAAD,EAEeE,sBAFf,IAAAD,KAEwCR,EAFxCpJ,OAAA8J,EAAA,EAAA9J,CAAA2J,EAAA,oCAAAlK,EAGmCsF,GAAQ,GAH3CgF,EAAAtK,EAGCqH,YAHD,IAAAiD,EAGQ,GAHRA,EAAAC,EAAAvK,EAGYsH,kBAHZ,IAAAiD,KAKDC,IAAkBlD,GAAU/G,OAAA0H,EAAA,EAAA1H,CAAA,CAChCkK,iBAAiB,EACjBC,iBAAiB,GACdpD,GAGCqD,EAAiD,CACrDhC,kBACAc,SAAU3D,KAAK4C,sBACfkC,iBAAkB,SAACC,GAAD,MAA4B,CAC5CjE,SAAUiE,EAAOjE,YAIrB,OACEkE,EAAA9I,EAAAC,cAAA,OAAKC,UAAWC,IAAO4I,eACpBX,EACCU,EAAA9I,EAAAC,cAAA,OAAKC,UAAWC,IAAO6I,YACrBF,EAAA9I,EAAAC,cAAA6E,EAAA,GACEC,QACE+D,EAAA9I,EAAAC,cAACgJ,EAAA,SAAD,2BACMH,EAAA9I,EAAAC,cAAA,KAAGc,MAAO,CAAEmI,WAAY,MAAQvC,EAAgB7H,QADtD,kBAEGgI,EAAc7H,IAAI,SAACoB,EAAM8I,GAAP,OACjBL,EAAA9I,EAAAC,cAAA,QAAMc,MAAO,CAAEqI,WAAY,GAAK7I,IAAKF,EAAK0B,WACvC1B,EAAKyB,MADR,mBAGEgH,EAAA9I,EAAAC,cAAA,QAAMc,MAAO,CAAEmI,WAAY,MACxB7I,EAAKgJ,OACFhJ,EAAKgJ,OAAOhJ,EAAK6F,MAAO7F,EAAuB8I,GAC/C9I,EAAK6F,UAIf4C,EAAA9I,EAAAC,cAAA,KAAGkB,QAAS2C,KAAKiE,kBAAmBhH,MAAO,CAAEqI,WAAY,KAAzD,iBAKJvE,KAAK,OACLyE,UAAQ,KAGZ,KAEFR,EAAA9I,EAAAC,cAAAsJ,EAAA,EAAAhL,OAAAiL,OAAA,CACEpE,OAAQA,GAAU,MAClBuD,aAAcP,EAAiBO,OAAehE,EAC9C8E,WAAYpE,EACZC,WAAYkD,EACZf,SAAU3D,KAAKwD,mBACXK,YAnHc+B,aA0HbvD,iDCpKfwD,EAAAC,QAAiBC,EAAAC,EAAuB,qDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,sDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,uDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB,qDCAxCH,EAAAC,QAAiBC,EAAAC,EAAuB","file":"static/js/20.401292bc.chunk.js","sourcesContent":["import React, {useCallback, useState } from 'react'\nimport {useDropzone} from 'react-dropzone'\nimport styles from './Dropzone.less'\nimport XLS from 'assets/xls.svg';\nimport XLSX from 'assets/xlsx.svg';\nimport TRASH from 'assets/trash.svg';\nimport { message } from 'antd';\nimport ZIP from 'assets/ZIP.svg';\nimport RAR from 'assets/RAR.svg';\n\ntype fileType = {\n  name: string;\n  lastModified: number;\n  suffix: string;\n}\n\ntype DropzonePropsType = {\n  saveFile: (file: File) => void;\n  content: any;\n  accept: string[];\n}\n\nfunction Dropzone({ saveFile, content, accept }: DropzonePropsType) {\n  const [files, setFiles] = useState<fileType[]>([]);\n  const onDrop = useCallback(acceptedFiles => {\n    if (!acceptedFiles.length) {\n      message.warning('请检查文件格式之后再试~')\n    }\n    setFiles(acceptedFiles.map((file:fileType ) => ({\n      name: file.name,\n      lastModified: file.lastModified,\n      suffix: (file.name.split('.').pop() || '').toLocaleLowerCase()\n    })))\n\n    saveFile(acceptedFiles[0])\n  }, [saveFile])\n\n  const { getRootProps, getInputProps} = useDropzone({ onDrop, accept});\n\n  const onClickDelete = (e: any) => {\n    setFiles([])\n  }\n  return (\n    <section className={styles.container}>\n      {\n        files.length ?\n          <div className='dropzone'>\n            {files.map((item, idx) => {\n              return <div key={item.lastModified} className=\"file-container\">\n                <div>\n                  {item.suffix === 'xlsx' && <img src={XLSX} alt=\"xlsx\" />}\n                  {item.suffix === 'xls' && <img src={XLS} alt=\"xls\" />}\n                  {item.suffix === 'zip' && <img src={ZIP} alt=\"zip\" />}\n                  {item.suffix === 'rar' && <img src={RAR} alt=\"zip\" />}\n\n                  <span className=\"file-title\">{item.name}</span>\n                </div>\n                <img src={TRASH} alt=\"\" style={{ width: 20, cursor: 'pointer' }} data-index={idx} onClick={onClickDelete}/>\n              </div>\n            })}\n          </div> :\n          <div {...getRootProps({className: 'dropzone'})}>\n            <input {...getInputProps()} />\n            {content}\n          </div>\n      }\n    </section>\n  );\n}\nDropzone.whyDidYouRender = true;\nexport default React.memo(Dropzone);\n","import React, {useState} from 'react';\nimport { Modal, Button, Alert, Icon } from 'antd';\nimport MyDropzone from './Dropzone';\nimport request from 'utils/request';\nimport { isSuccess } from 'utils';\nimport configs from 'utils/config';\nimport StandardTable, {StandardTableColumnProps} from 'components/StandardTable';\nimport ZIP from 'assets/ZIP.svg';\nimport RAR from 'assets/RAR.svg';\ntype ModalPropsType  = {\n  visible: boolean;\n  toggleVisible: any;\n}\n\nconst defaultStatus = { uploaded: false, failNum: 0, successNum: 0, totalNum: 0, errorList:[] };\nconst accept: string[] = ['.zip', '.rar'];\n\nconst columns:StandardTableColumnProps[] = [\n  {\n    title: '学生',\n    dataIndex: 'name',\n  },\n  {\n    title: '性别',\n    dataIndex: 'sexStr',\n  },\n  {\n    title: '年龄',\n    dataIndex: 'age',\n  },\n  {\n    title: '学号',\n    dataIndex: 'sn',\n  },\n  {\n    title: '院系',\n    dataIndex: 'college',\n  },\n  {\n    title: '年级',\n    dataIndex: 'grade',\n  },\n  {\n    title: '班级',\n    dataIndex: 'clazz',\n  },\n]\n\nconst UploadModal = ({visible, toggleVisible}: ModalPropsType) => {\n\n  const [file, setFile] = useState()\n  const [upStatus, setUpStatus] = useState(defaultStatus)\n\n  const saveFile = (file: File) => {\n    let formData = new FormData();\n    formData.append('file', file);\n    setFile(formData)\n  }\n\n  const handleSubmit = async () => {\n    const res  = await request({\n      url: '/file/uploadPics',\n      data: file,\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    })\n    if (isSuccess(res)) {\n      setUpStatus({\n        uploaded: true,\n        ...res.data\n      })\n    }\n  }\n  const resetModal = () => {\n    setFile(undefined)\n    setUpStatus(defaultStatus)\n  }\n  const content = (\n    <>\n      <div style={{ display:'flex'}}>\n        <img src={ZIP} alt=\"\" style={{ width: 60 }} />\n        <img src={RAR} alt=\"\" style={{width:60}}/>\n      </div>\n      <h1 style={{marginTop: 20}}>将文件拖拽至此区域 或 <a>点击上传</a></h1>\n      <span>仅限制上传100M以下RAR或ZIP格式文件</span>\n    </>\n  )\n  return (\n    <Modal\n      title=\"上传基础数据\"\n      width=\"60%\"\n      visible={visible}\n      onCancel={toggleVisible}\n      centered\n      footer={\n        <div style={{ alignItems: 'center', justifyContent: 'center', display:'flex' }}>\n          {\n            upStatus.uploaded ?\n              <Button onClick={resetModal} disabled={!file}>再次上传</Button> :\n              <Button type='primary' onClick={handleSubmit} disabled={!file}>上传</Button>\n          }\n\n        </div>\n      }\n    >\n      <Alert\n        message=\"注意事项\"\n        description={\n          <>\n            <p><b>1.</b>上传前请先先将每张图片命名为学号，如201800001</p>\n            <p><b>2.</b>命名后请将所有图片打包压缩，文件大小不能超过100M</p>\n            <p><b>3.</b>压缩包支持zip和rar格式</p>\n          </>\n        }\n        type=\"info\"\n      />\n\n      <div style={{marginTop:20, marginBottom: 10}}>\n      </div>\n      {\n        upStatus.uploaded ?\n          <>\n            <h3>共上传\n              <b style={{ color: '#1890ff' }}>{upStatus.totalNum}</b>条数据,\n              成功<b style={{ color: '#1890ff' }}>{upStatus.successNum}</b>条,\n              失败<b style={{ color: '#FF4D4F' }}>{upStatus.failNum}</b>条\n            </h3>\n            {\n              upStatus.errorList.length ?\n                <>\n                  <h5 style={{color: 'red'}}>上传出错, 出错信息如下:</h5>\n                  <ul>\n                    {\n                      upStatus.errorList.map(item => {\n                        return <li key={item}>{item}</li>\n                      })\n                    }\n                  </ul>\n                </>\n                :\n                null\n            }\n            <StandardTable\n              rowKey='key'\n              columns={columns}\n              data={{\n                list: [{name: '123', key:1}],\n                pagination: {}\n              }}\n            />\n          </> :\n          <MyDropzone\n            saveFile={saveFile}\n            content={content}\n            accept={accept}\n          />\n      }\n    </Modal>\n  )\n}\nUploadModal.whyDidYouRender = true\n\nexport default React.memo(UploadModal)\n","import { Alert, Table } from 'antd';\nimport { ColumnProps, TableRowSelection, TableProps } from 'antd/es/table';\nimport React, { Component, Fragment } from 'react';\n\nimport { TableListItem } from './data.d';\nimport styles from './index.less';\ntype Omit<T, K extends keyof T> = Pick<T, Exclude<keyof T, K>>;\n\nexport interface StandardTableProps<T> extends Omit<TableProps<T>, 'columns'> {\n  columns: StandardTableColumnProps[];\n  data: {\n    list: TableListItem[];\n    pagination: StandardTableProps<TableListItem>['pagination'];\n  };\n  selectedRows?: TableListItem[];\n  needSelectRows?: boolean;\n  onSelectRow?: (rows: any) => void;\n}\n\nexport interface StandardTableColumnProps extends ColumnProps<TableListItem> {\n  needTotal?: boolean;\n  total?: number;\n}\n\nfunction initTotalList(columns: StandardTableColumnProps[]) {\n  if (!columns) {\n    return [];\n  }\n  const totalList: StandardTableColumnProps[] = [];\n  columns.forEach(column => {\n    if (column.needTotal) {\n      totalList.push({ ...column, total: 0 });\n    }\n  });\n  return totalList;\n}\n\ninterface StandardTableState {\n  selectedRowKeys: string[];\n  needTotalList: StandardTableColumnProps[];\n}\n\nclass StandardTable extends Component<StandardTableProps<TableListItem>, StandardTableState> {\n  static getDerivedStateFromProps(nextProps: StandardTableProps<TableListItem>) {\n    // clean state\n    if (nextProps.selectedRows && nextProps.selectedRows.length === 0) {\n      const needTotalList = initTotalList(nextProps.columns);\n      return {\n        selectedRowKeys: [],\n        needTotalList,\n      };\n    }\n    return null;\n  }\n\n  constructor(props: StandardTableProps<TableListItem>) {\n    super(props);\n    const { columns } = props;\n    const needTotalList = initTotalList(columns);\n\n    this.state = {\n      selectedRowKeys: [],\n      needTotalList,\n    };\n  }\n\n  handleRowSelectChange: TableRowSelection<TableListItem>['onChange'] = (\n    selectedRowKeys,\n    selectedRows: TableListItem[],\n  ) => {\n    const currySelectedRowKeys = selectedRowKeys as string[];\n    let { needTotalList } = this.state;\n    needTotalList = needTotalList.map(item => ({\n      ...item,\n      total: selectedRows.reduce((sum, val) => sum + parseFloat(val[item.dataIndex || 0]), 0),\n    }));\n    const { onSelectRow } = this.props;\n    if (onSelectRow) {\n      onSelectRow(selectedRows);\n    }\n\n    this.setState({ selectedRowKeys: currySelectedRowKeys, needTotalList });\n  };\n\n  handleTableChange: TableProps<TableListItem>['onChange'] = (\n    pagination,\n    filters,\n    sorter,\n    ...rest\n  ) => {\n    const { onChange } = this.props;\n    if (onChange) {\n      onChange(pagination, filters, sorter, ...rest);\n    }\n  };\n\n  cleanSelectedKeys = () => {\n    if (this.handleRowSelectChange) {\n      this.handleRowSelectChange([], []);\n    }\n  };\n\n  render() {\n    const { selectedRowKeys, needTotalList } = this.state;\n    const { data, rowKey, needSelectRows=false, ...rest } = this.props;\n    const { list = [], pagination = false } = data || {};\n\n    const paginationProps = pagination ? {\n      showSizeChanger: true,\n      showQuickJumper: true,\n      ...pagination,\n    } : false;\n\n    const rowSelection: TableRowSelection<TableListItem> = {\n      selectedRowKeys,\n      onChange: this.handleRowSelectChange,\n      getCheckboxProps: (record: TableListItem) => ({\n        disabled: record.disabled,\n      }),\n    };\n\n    return (\n      <div className={styles.standardTable}>\n        {needSelectRows ?\n          <div className={styles.tableAlert}>\n            <Alert\n              message={\n                <Fragment>\n                  已选择 <a style={{ fontWeight: 600 }}>{selectedRowKeys.length}</a> 项&nbsp;&nbsp;\n                  {needTotalList.map((item, index) => (\n                    <span style={{ marginLeft: 8 }} key={item.dataIndex}>\n                      {item.title}\n                      总计&nbsp;\n                      <span style={{ fontWeight: 600 }}>\n                        {item.render\n                          ? item.render(item.total, item as TableListItem, index)\n                          : item.total}\n                      </span>\n                    </span>\n                  ))}\n                  <a onClick={this.cleanSelectedKeys} style={{ marginLeft: 24 }}>\n                    清空\n                  </a>\n                </Fragment>\n              }\n              type=\"info\"\n              showIcon\n            />\n          </div> :\n          null\n        }\n        <Table\n          rowKey={rowKey || 'key'}\n          rowSelection={needSelectRows ? rowSelection : undefined}\n          dataSource={list}\n          pagination={paginationProps}\n          onChange={this.handleTableChange}\n          {...rest}\n        />\n      </div>\n    );\n  }\n}\n\nexport default StandardTable;\n","module.exports = __webpack_public_path__ + \"static/media/xls.e3b573bf.svg\";","module.exports = __webpack_public_path__ + \"static/media/xlsx.99625958.svg\";","module.exports = __webpack_public_path__ + \"static/media/trash.3d4303e4.svg\";","module.exports = __webpack_public_path__ + \"static/media/ZIP.f176b939.svg\";","module.exports = __webpack_public_path__ + \"static/media/RAR.a1b093e9.svg\";"],"sourceRoot":""}